<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>EventHub - Your Event Management Platform</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/animate.css/4.1.1/animate.min.css">
    <link rel="stylesheet" href="index.css">
    <style>
        @font-face {
            font-family: 'BlushAsliring';
            src: url('static/fonts/PlayfairDisplay-VariableFont_wght.ttf') format('opentype');
            font-weight: normal;
            font-style: normal;
        }
        /* Banner (hero-section) headings and nav links use BlushAsliring */
        .hero-section h1,
        .hero-section h2,
        .hero-section h3,
        .hero-section .hero-glitch-text,
        .hero-section .hero-title-wrapper,
        .hero-section .hero-content-left p,
        .hero-section .btn-primary,
        .main-nav .nav-links a,
        .main-nav .logo a {
            font-family: 'BlushAsliring', 'PlayfairDisplay', serif !important;
            letter-spacing: 0.5px;
        }
        
        /* Fix footer padding issues */
        footer {
            padding-bottom: 0;
            margin-bottom: 0;
        }
        
        .footer-bottom {
            padding: 1.5rem 0;
            margin-bottom: 0;
        }
        
        .footer-bottom p {
            margin-bottom: 0;
        }
        
        html, body {
            margin-bottom: 0;
            padding-bottom: 0;
        }
    </style>
</head>
<body>
    <!-- Custom Cursor -->
    <div class="cursor"></div>
    <div class="cursor-follower"></div>

    <!-- Background Effects -->
    <div class="gradient-bg"></div>
    <div class="noise-overlay"></div>
    <div class="particles" id="particles-js"></div>
    
    <!-- Header -->
    <header>
        <nav class="main-nav">
            <div class="logo">
                <a href="#">EventHub</a>
            </div>
            <ul class="nav-links">
              <li><a href="index.html" class="active">Home</a></li>
              <li><a href="announcements.html">Events</a></li>
              <li><a  href="about.html">About Us</a></li>
              <li><a href="about.html#contact">Contact</a></li>
          </ul>
            <div class="profile-icon">
                <a href="#" id="profileIconLink" aria-haspopup="true" aria-expanded="false" title="Profile menu">
                    <i class="fas fa-user"></i>
                </a>
                <div class="profile-dropdown-menu" role="menu" id="profileDropdown">
                    <a href="handler-dashboard.html" role="menuitem"><i class="fas fa-tachometer-alt"></i> Handler Dashboard</a>
                    <a href="#" id="logoutBtnDropdown" role="menuitem"><i class="fas fa-sign-out-alt"></i> Logout</a>
                </div>
            </div>
            <button id="hamburger-menu">
                <span></span>
                <span></span>
                <span></span>
            </button>
        </nav>
    </header>    <!-- Main Content -->
    <main>
        <!-- Hero Section -->
        <section class="hero-section"> <!-- Changed class to hero-section for new style -->
          <!-- Interactive background container -->
          <div id="hero-interactive-bg" class="hero-interactive-bg"></div>
          
          <div class="hero-main-row">
              <div class="hero-content-left">
                <div class="hero-title-wrapper"> <!-- Wrapper for reveal animation -->
                  <h1 class="hero-glitch-text">Plan, Discover, Connect</h1>
                </div>
                  <p>EventHub brings all your campus events and announcements into one organized space.</p>
                  <div class="hero-btn-row">
                      <a href="register-handler.html" class="btn-primary">Apply for Handler<i class="fas fa-arrow-right"></i></a>
                      <a href="announcements.html" class="btn-primary">Browse Events <i class="fas fa-calendar-alt"></i></a>
                  </div>
              </div>
              <div class="hero-image-right">
                  <img src="https://i.pinimg.com/736x/8d/23/ff/8d23ff5472d7571a52bf12504004ac48.jpg" alt="Dynamic Event Platform Showcase">
              </div>
          </div>
        </section>

        <!-- <div class="event-banner"> // Added this wrapper div 
            <div class="event-banner-image-wrapper">
              <img src="https://i.pinimg.com/736x/59/fb/95/59fb95b7b6358c43b120b953e1f8ec65.jpg" alt="Event Preview">
            </div>
          </div> -->

        <!-- Why EventHub Section -->
        <section class="section-light" id="why-section">
            <div class="dashboard-container">
                <h2 class="why-title">Why Choose EventHub</h2>
                <div class="features-row">
                    <div class="feature-box">
                        <div class="feature-icon">
                            <i class="fas fa-calendar-check"></i>
                        </div>
                        <h3>Centralized Event Calendar</h3>
                        <p>All your events in one place, always up to date.</p>
                    </div>
                    <div class="feature-box">
                        <div class="feature-icon">
                            <i class="fas fa-users"></i>
                        </div>
                        <h3>Real-time Announcements</h3>
                        <p>Never miss an important update from your societies.</p>
                    </div>
                    <div class="feature-box">
                        <div class="feature-icon">
                            <i class="fas fa-chart-line"></i>
                        </div>
                        <h3>Easy RSVP Management</h3>
                        <p>RSVP and manage your attendance with a click.</p>
                    </div>
                </div>
            </div>
        </section>

        <!-- Upcoming Events Section
        <section class="section-alt" id="events-section">
            <div class="dashboard-container">
                <div class="section-header">
                    <h2>Featured Events</h2>
                    <a href="#" class="view-all">View All Events</a>
                </div>
                <div class="events-row">
                    
                </div>
            </div>
        </section> -->

        <!-- FAQ Section -->
        <section class="faq-section" id="faq-section">
            <div class="dashboard-container">
                <div class="faq-split">
                    <div class="faq-left">
                        <h2 class="faq-title">Frequently Asked Questions</h2>
                        <p class="faq-desc">Find quick answers to common questions about our platform, event creation, and community engagement.</p>
                        <a href="about.html#contact" class="btn-primary">Contact Support <i class="fas fa-headset"></i></a>
                    </div>
                    <div class="faq-right">
                        <ul class="faq-list">
                            <li class="faq-item" style="--faq-index: 0;">
                                <button class="faq-question">What is EventHub?</button>
                                <div class="faq-answer">
                                    <p>EventHub is a platform that centralizes all campus events and announcements, making it easy to stay informed and participate.</p>
                                </div>
                            </li>
                            <li class="faq-item" style="--faq-index: 1;">
                                <button class="faq-question">Is there any additional fee?</button>
                                <div class="faq-answer">
                                    <p>No, there is no additional fees. Everything is included in your EventHub experience.</p>
                                </div>
                            </li>
                            <li class="faq-item" style="--faq-index: 2;">
                                <button class="faq-question">How do I join a Society?</button>
                                <div class="faq-answer">
                                    <p>To join a society, search for the society in the "My Societies" section in your dashboard. Enter the referral code and click "Join" or "Request to Join" depending on their membership settings. Some societies may require approval before you can become a member.</p>
                                </div>
                            </li>
                            <li class="faq-item" style="--faq-index: 3;">
                                <button class="faq-question">Can I create my own events?</button>
                                <div class="faq-answer">
                                    <p>If you're a society handler, you can register and create events for your organization. Viewers can only RSVP and follow events.</p>
                                </div>
                            </li>
                            <li class="faq-item" style="--faq-index: 4;">
                                <button class="faq-question">Is EventHub free to use?</button>
                                <div class="faq-answer">
                                    <p>Yes! EventHub is free for all students and societies to use</p>
                                </div>
                            </li>
                        </ul>
                    </div>
                </div>
            </div>
        </section>

        <!-- Call to Action Section -->
        <section class="cta-section">
            <div class="cta-bg-shapes">
                <div class="cta-shape"></div>
                <div class="cta-shape"></div>
                <div class="cta-shape"></div>
            </div>
            <div class="cta-container">
                <h2 class="cta-title">Ready to Start Planning?</h2>
                <p class="cta-text">Join thousands of organizations and individuals who use EventHub to create memorable events and build thriving communities.</p>
                <div style="display: flex; gap: 1rem; flex-wrap: wrap; justify-content: center;">
                  <button class="cta-btn" onclick="window.location.href='register-handler.html'">Apply for Handler</button>
                  <button class="cta-btn" style="background: var(--hover-color); color: #fff;" onclick="window.location.href='register.html'">Register as Viewer</button>
                </div>
            </div>
        </section>
    </main>

      <!-- Footer -->
      <footer>
        <div class="footer-container">
            <div class="footer-col">
                <a href="index.html" class="footer-logo">EventHub</a>
                <p class="footer-description">Connecting people with experiences that matter. Discover, book, and enjoy events seamlessly with our innovative platform.</p>
                <div class="footer-social">
                    <a href="#"><i class="fab fa-facebook-f"></i></a>
                    <a href="#"><i class="fab fa-twitter"></i></a>
                    <a href="#"><i class="fab fa-instagram"></i></a>
                    <a href="#"><i class="fab fa-linkedin-in"></i></a>
                </div>
            </div>
            
            <div class="footer-links">
                <h4>Quick Links</h4>
                <ul>
                    <li><a href="index.html">Home</a></li>
                    <li><a href="announcements.html">Browse Events</a></li>
                    <li><a href="about.html">About Us</a></li>
                    <li><a href="about.html#contact">Contact</a></li>
                    <li><a href="index.html#faq-section">FAQ</a></li>
                </ul>
            </div>
            
              <div class="footer-links">
                  <h4>Account</h4>
                  <ul>
                      <li><a href="login.html">Login</a></li>
                      <li><a href="register.html">Create Account</a></li>
                      <li><a href="register-handler.html">Society Signup</a></li>
                  </ul>
              </div>
        </div>
        
        <div class="footer-bottom">
            <p>&copy; 2025 EventHub. All rights reserved.</a></p>
        </div>
    </footer>

    <!-- JavaScript -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/particles.js/2.0.0/particles.min.js"></script>
    <script>
        // Cursor Effect
        const cursor = document.querySelector('.cursor');
        const follower = document.querySelector('.cursor-follower');
        
        document.addEventListener('mousemove', (e) => {
            cursor.style.left = e.clientX + 'px';
            cursor.style.top = e.clientY + 'px';
            
            setTimeout(() => {
                follower.style.left = e.clientX + 'px';
                follower.style.top = e.clientY + 'px';
            }, 100);
        });
        
        document.addEventListener('mousedown', () => {
            cursor.classList.add('cursor-hover');
            follower.classList.add('follower-hover');
        });
        
        document.addEventListener('mouseup', () => {
            cursor.classList.remove('cursor-hover');
            follower.classList.remove('follower-hover');
        });
        
        const links = document.querySelectorAll('a, button, .btn-primary, .btn-outline');
        links.forEach(link => {
            link.addEventListener('mouseenter', () => {
                cursor.classList.add('cursor-hover');
                follower.classList.add('follower-hover');
            });
            
            link.addEventListener('mouseleave', () => {
                cursor.classList.remove('cursor-hover');
                follower.classList.remove('follower-hover');
            });
        });
        
        // Particles JS
        if (window.particlesJS) {
            particlesJS('particles-js', {
                particles: {
                    number: { value: 30, density: { enable: true, value_area: 800 } },
                    color: { value: '#002366' },
                    shape: { type: 'circle' },
                    opacity: { value: 0.3, random: true },
                    size: { value: 5, random: true },
                    move: {
                        enable: true,
                        speed: 1,
                        direction: 'none',
                        random: true,
                        straight: false,
                        out_mode: 'out'
                    }
                },
                interactivity: {
                    detect_on: 'canvas',
                    events: {
                        onhover: { enable: true, mode: 'bubble' },
                        onclick: { enable: true, mode: 'push' }
                    },
                    modes: {
                        bubble: { distance: 250, size: 6, duration: 2 },
                        push: { particles_nb: 3 }
                    }
                }
            });
        }
        
        // Sticky Header
        const header = document.querySelector('header');
        window.addEventListener('scroll', () => {
            if (window.scrollY > 50) {
                header.classList.add('scrolled');
            } else {
                header.classList.remove('scrolled');
            }
        });
        
        // Mobile Navigation
        const hamburger = document.getElementById('hamburger-menu');
        const navLinks = document.querySelector('.nav-links');
        
        hamburger.addEventListener('click', () => {
            hamburger.classList.toggle('open');
            navLinks.classList.toggle('active');
        });
        
        // Close mobile menu when clicking a link
        document.querySelectorAll('.nav-links a').forEach(link => {
            link.addEventListener('click', () => {
                hamburger.classList.remove('open');
                navLinks.classList.remove('active');
            });
        });
        
        // FAQ Accordion
        const faqQuestions = document.querySelectorAll('.faq-question');
        
        faqQuestions.forEach(question => {
            question.addEventListener('click', () => {
                const faqItem = question.parentElement;
                faqItem.classList.toggle('open');
                
                // Close other open FAQs
                faqQuestions.forEach(q => {
                    if (q !== question) {
                        q.parentElement.classList.remove('open');
                    }
                });
            });
        });
        
        // --- RSVP Button Toggle & Success Message ---
        const rsvpStatus = {}; // To store RSVP state for each event

        function showSuccessToast(message) {
            // Remove any existing toast
            const existingToast = document.querySelector('.success-toast');
            if (existingToast) {
                existingToast.remove();
            }

            const toast = document.createElement('div');
            toast.className = 'success-toast';
            toast.textContent = message;
            document.body.appendChild(toast);

            // Trigger the show animation
            setTimeout(() => {
                toast.classList.add('show');
            }, 10); // Small delay to ensure transition triggers

            // Hide and remove after 3 seconds
            setTimeout(() => {
                toast.classList.remove('show');
                toast.classList.add('hide');
                setTimeout(() => {
                    toast.remove();
                }, 300); // Wait for hide animation to complete
            }, 3000);
        }
        const rsvpButtons = document.querySelectorAll('.rsvp-btn');
        
        rsvpButtons.forEach(button => {
            button.addEventListener('click', () => {
                const eventName = button.dataset.eventName;
                const icon = button.querySelector('i');
                const span = button.querySelector('span');

                button.classList.toggle('rsvp-active');
                                
                if (button.classList.contains('rsvp-active')) {
                    rsvpStatus[eventName] = true;
                    icon.classList.remove('far', 'fa-star');
                    icon.classList.add('fas', 'fa-star');
                    span.textContent = 'RSVP\'d';
                    showSuccessToast(`You have successfully RSVP'd to ${eventName}!`);
                } else {
                    rsvpStatus[eventName] = false;
                    icon.classList.remove('fas', 'fa-star');
                    icon.classList.add('far', 'fa-star');
                    span.textContent = 'RSVP Now';
                    showSuccessToast(`You have canceled your RSVP for ${eventName}.`);
                }
            });
        });
        
        // Intersection Observer for animations
        const observerOptions = {
            threshold: 0.2,
            rootMargin: '0px 0px -100px 0px'
        };

        const observer = new IntersectionObserver((entries) => {
            entries.forEach(entry => {
                if (entry.isIntersecting) {
                const targetElement = entry.target;
                targetElement.classList.add('in-view');

                // Special handling for title character animation
                if (targetElement.id === 'announcement-title' && targetElement.classList.contains('in-view')) {
                    const chars = targetElement.querySelectorAll('.char');
                    if (chars.length > 0) {
                        chars.forEach((char, index) => {
                            // The CSS already handles the transition, this just ensures .in-view is on the parent
                            // The CSS uses transition-delay on .char based on --char-index if you set it,
                            // or you can apply it here if preferred.
                            // For simplicity, the current CSS uses #announcement-title.in-view .char for direct animation.
                            // If staggered delay is needed via JS:
                            // char.style.transitionDelay = `${index * 0.03}s`; // Example
                        });
                    }
                }                    // Optionally unobserve after animation
                observer.unobserve(entry.target);
                }
            });
        }, observerOptions);

        // Observe elements for animation
        // Hero elements (.hero-title-wrapper, .hero-content-left p, .hero-btn-row, .hero-image-right, .hero-stats-row, .hero-stat-item) have on-load animations defined in CSS.
        const animatedElements = document.querySelectorAll('.event-banner, .why-title, .feature-box, .section-header, .event-card, .announcement-card, .faq-left, .faq-right, .faq-item, .cta-title, .cta-text, .cta-btn');        animatedElements.forEach(element => {
            observer.observe(element);
        });

        // Initialize any other UI components
        document.addEventListener('DOMContentLoaded', () => {
            // Maybe initialize tooltips, popovers, etc.

            // Auto open first FAQ item
            const firstFaq = document.querySelector('.faq-item');
            if (firstFaq) {
                firstFaq.classList.add('open');
            }
        });
        
          // Profile Dropdown Toggle
          const profileIconLink = document.getElementById('profileIconLink');
          const profileDropdown = document.getElementById('profileDropdown');

          function updateProfileDropdown() {
            const accessToken = localStorage.getItem('access_token');
            const userType = localStorage.getItem('user_type');
            profileDropdown.innerHTML = '';
            if (accessToken) {
              // User is logged in
              profileDropdown.innerHTML = `
                <a href="${userType === 'handler' ? 'handler-dashboard.html' : 'viewer-dashboard.html'}" role="menuitem">
                  <i class="fas fa-tachometer-alt"></i> ${userType === 'handler' ? 'Handler Dashboard' : 'Viewer Dashboard'}
                </a>
                <a href="#" id="logoutBtnDropdown" role="menuitem"><i class="fas fa-sign-out-alt"></i> Logout</a>
              `;
            } else {
              // Not logged in
              profileDropdown.innerHTML = `
                <a href="login.html" role="menuitem"><i class="fas fa-sign-in-alt"></i> Login</a>
                <a href="register.html" role="menuitem"><i class="fas fa-user-plus"></i> Register</a>
              `;
            }
          }

          if (profileIconLink && profileDropdown) {
            updateProfileDropdown();
            profileIconLink.addEventListener('click', (event) => {
                event.preventDefault();
                const isExpanded = profileIconLink.getAttribute('aria-expanded') === 'true' || false;
                profileIconLink.setAttribute('aria-expanded', !isExpanded);
                profileDropdown.classList.toggle('active');
                updateProfileDropdown();
            });

            // Close dropdown if clicked outside
            document.addEventListener('click', (event) => {
                if (!profileIconLink.contains(event.target) && !profileDropdown.contains(event.target)) {
                    if (profileDropdown.classList.contains('active')) {
                        profileDropdown.classList.remove('active');
                        profileIconLink.setAttribute('aria-expanded', 'false');
                    }
                }
            });

            // Close dropdown with Escape key
            document.addEventListener('keydown', (event) => {
                if (event.key === 'Escape' && profileDropdown.classList.contains('active')) {
                    profileDropdown.classList.remove('active');
                    profileIconLink.setAttribute('aria-expanded', 'false');
                }
            });

            // Logout button logic (delegated)
            profileDropdown.addEventListener('click', (event) => {
              if (event.target.closest('#logoutBtnDropdown')) {
                event.preventDefault();
                // Remove tokens and user info
                localStorage.removeItem('access_token');
                localStorage.removeItem('refresh_token');
                localStorage.removeItem('user_type');
                localStorage.removeItem('user_id');
                localStorage.removeItem('join_code');
                // Redirect to login page
                window.location.href = 'login.html';
              }
            });
          }
          
        // --- Featured Events Dynamic Loading (uses index.js logic) ---
        (async function loadFeaturedEvents() {
            try {
                const token = localStorage.getItem('access_token');
                const response = await fetch('http://127.0.0.1:8000/api/events/', {
                    headers: token ? { 'Authorization': `Bearer ${token}` } : {}
                });
                if (!response.ok) throw new Error('Failed to fetch events');
                const data = await response.json();
                // Debug: log the full API response
                console.log('API response for events:', data);
                // Accept both paginated and non-paginated API responses
                const events = Array.isArray(data.results) ? data.results : (Array.isArray(data) ? data : []);
                console.log('Parsed events array:', events);
                if (events.length > 0) {
                    console.log('First event object:', events[0]);
                }
                const eventsRow = document.querySelector('.events-row');
                if (!eventsRow) return;
                eventsRow.innerHTML = '';
                if (events.length === 0) {
                    eventsRow.innerHTML = '<p style="color:#c00;">No events found.</p>';
                    return;
                }
                // Only display the first 3 events
                events.slice(0, 3).forEach(event => {
                    // Debug: log each event being rendered
                    console.log('Rendering event:', event);
                    const card = document.createElement('div');
                    card.className = 'event-card';
                    card.innerHTML = `
                        <img src="${event.banner || 'static/images/placeholder.png'}" alt="${event.name || 'Event'}">
                        <div class="event-title-line">
                          <h3>${event.name || ''}</h3>
                          <span class="event-category-tag">${event.category_name || ''}</span>
                        </div>
                        <div class="event-date">
                            <i class="far fa-calendar"></i>
                            <span>${event.date ? new Date(event.date).toLocaleDateString(undefined, { month: 'long', day: 'numeric', year: 'numeric' }) : ''}</span>
                        </div>
                        <div class="event-location">
                            <i class="fas fa-map-marker-alt"></i>
                            <span>${event.location || ''}</span>
                        </div>
                        <p>${event.description ? event.description.substring(0, 120) + (event.description.length > 120 ? '...' : '') : ''}</p>
                        <button class="rsvp-btn" data-event-id="${event.id}" data-event-name="${event.name}">
                          <i class="far fa-star"></i>
                          <span>RSVP Now</span>
                        </button>
                    `;
                    eventsRow.appendChild(card);
                });
            } catch (err) {
                const eventsRow = document.querySelector('.events-row');
                if (eventsRow) eventsRow.innerHTML = '<p style="color:#c00;">Failed to load events.</p>';
                console.error('Error loading events:', err);
            }
            
        }
        
    )();
    </script>
</body>
</html>
